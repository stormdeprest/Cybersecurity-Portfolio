# Vulnerability Scanning & Management

## What are Vulnerabilities?

**Vulnerability** = Weakness in software/hardware that attackers can exploit to compromise systems.

**Analogy**: Like small holes in a roof that let water, dust, and insects enter - seem minor but cause major damage if unaddressed.

**Patching** = Process of fixing vulnerabilities with software updates.

---

## Why Vulnerability Scanning?

**Purpose**: Inspect digital systems to find weaknesses before attackers exploit them.

**Importance:**
- Organizations store critical information in digital infrastructure
- Attackers constantly search for exploitable weaknesses
- Vulnerabilities often invisible until actively hunted
- Compliance requirement for many regulatory standards

**Frequency:**
- Some standards: Quarterly scans
- Others: Annual scans
- Best practice: Regular automated scanning

---

## Manual vs Automated Scanning

### Manual Scanning
**Problems:**
- Time-consuming and labor-intensive
- Easy to miss critical vulnerabilities
- Slower as network size increases
- Not scalable

### Automated Scanning
**Benefits:**
- Automated vulnerability detection
- Efficient and comprehensive
- Easy-to-read reports
- Only requires IP address or network range

---

## Types of Vulnerability Scans

### Authenticated vs Unauthenticated

| Authenticated | Unauthenticated |
|---------------|-----------------|
| **Requires**: Host credentials | **Requires**: Only IP address |
| **Identifies**: Internal vulnerabilities (insider perspective) | **Identifies**: External vulnerabilities (attacker perspective) |
| **Visibility**: Deep - scans configurations, installed apps | **Visibility**: Surface-level |
| **Resource**: More intensive | **Resource**: Less intensive, easier setup |
| **Example**: Scanning internal database with credentials | **Example**: Scanning public website without access |

### Internal vs External

| Internal Scans | External Scans |
|----------------|----------------|
| **Conducted**: From inside network | **Conducted**: From outside network |
| **Focus**: Vulnerabilities exploitable by insiders or after initial breach | **Focus**: Vulnerabilities exposed to Internet |
| **Identifies**: Post-compromise attack surface | **Identifies**: Initial attack vectors |

**Common Practice**: 
- Internal scans → Authenticated
- External scans → Unauthenticated

---

## CVE (Common Vulnerabilities and Exposures)

**Definition**: Unique identifier for publicly known vulnerabilities.

**Developed by**: MITRE Corporation

### CVE Format

**Example**: CVE-2024-9374

**Structure:**
1. **Prefix**: "CVE"
2. **Year**: Discovery year (e.g., 2024)
3. **ID**: 4+ arbitrary digits (e.g., 9374)

**Purpose:**
- Track specific vulnerabilities
- Standardized reference system
- Published in CVE database for public awareness
- Enables patch identification and remediation

---

## CVSS (Common Vulnerability Scoring System)

**Definition**: Scoring system rating vulnerability severity from 0.0 to 10.0.

### CVSS Score Ranges

| Score Range | Severity |
|-------------|----------|
| 0.0 - 3.9 | **Low** |
| 4.0 - 6.9 | **Medium** |
| 7.0 - 8.9 | **High** |
| 9.0 - 10.0 | **Critical** |

**Calculation Based On:**
- Impact potential
- Ease of exploitation
- Attack complexity
- Required privileges
- User interaction needed

**Purpose**: Prioritize remediation efforts (fix critical vulnerabilities first)

---

## OpenVAS - Open-Source Vulnerability Scanner

### Installation (Docker Method)

**Install Docker:**
```bash
sudo apt install docker.io
```

**Install OpenVAS Container:**
```bash
sudo docker run -d -p 443:443 --name openvas immauss/openvas
```

**Access OpenVAS:**
```
https://127.0.0.1
```

---

## Performing Vulnerability Scan in OpenVAS

### Workflow

**1. Create Task**
- Navigate: Scans → Tasks
- Click: Star icon → New Task
- Enter: Task name

**2. Configure Target**
- Click: "Scan Targets"
- Enter: Target name and IP address
- Click: "Create"

**3. Select Scan Type**
- Choose appropriate scan configuration
- Different scan types have different scopes
- Click: "Create"

**4. Execute Scan**
- Click: Play button in "Actions" column
- Wait: Few minutes for completion
- Status: Changes to "Done" when finished

**5. View Results**
- Dashboard shows severity visualizations
- Click: Task name for detailed view
- Click: Vulnerability count for complete list

**6. Analyze Vulnerabilities**
- List displays all discovered vulnerabilities
- Color-coded by severity
- Click individual vulnerability for details:
  - CVE number
  - CVSS score
  - Description
  - Affected software
  - Remediation steps

**7. Export Reports**
- Available from Tasks dashboard
- Multiple format options (PDF, XML, CSV)

---

## Key Takeaways

- **Vulnerabilities** = exploitable weaknesses in systems
- **Automated scanning** essential for comprehensive coverage
- **Authenticated scans** provide deeper visibility (internal perspective)
- **Unauthenticated scans** show external attack surface
- **CVE** = unique vulnerability identifier
- **CVSS** = severity scoring (0-10 scale)
- **OpenVAS** = popular open-source scanner
- **Regular scanning** + **prompt patching** = strong security posture